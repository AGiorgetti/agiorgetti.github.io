---
layout: post
title: Install SQL Server (Express) with your Application
tags:
- Custom setup
- Embedding
- Installation
- Sql server express
---

During the last days I had to put my hands on an hold project written for .NET Framework 1.1 and convert his database from Access to SQL Express 2005, the conversion was quite easy but then the deployment phase stepped in.<br /><br />We had the requirement of allowing the deployment of the database engine along with the application (ClickOnce is not an option in VS.2003 :D), the Setup project that comes along with VS 2003 rely on merge modules to install external components, but unfortunately no merge module exists for SQL Express (they have been deprecated). So I started looking around for a solution and I came to this msdn article: <a href="http://msdn.microsoft.com/en-us/library/bb264562.aspx" target="_blank">Embedding SQL Server Express into Custom Applications</a>.<br /><br />Basically they suggest to write down a wrapper around the installation of the two components (SQL Express and the application) and launch the SQL installer in unattended mode with a shell command like: “start /wait setup.exe /qb /settings c:\template.ini” in which the configuration settings are passed in using the template.ini file or passing all the configuration parameters as command line arguments.<br /><br />So I took out the code they present in the article, corrected a few minor problems and created a basic installation wrapper that offer the option to select if install the SQL Engine (along with the database files or with a series of scripts to create the databases...this implementation is left to you in this sample project), one or more MSI packages that install the real application software or both.<br /><br />The wizard is graphically ugly to see (some screens follows) and you need to customize it to fir your company installation templates styles; the code behind surely need some refactoring but it actually works.<br /><br /><a href="/UserFiles/Guardian/2009/01/installerbootstrap1.png"><img style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" title="InstallerBootStrap1" src="/UserFiles/Guardian/2009/01/installerbootstrap1-thumb.png" border="0" alt="InstallerBootStrap1" width="252" height="194" /></a> <a href="/UserFiles/Guardian/2009/01/installerbootstrap2.png"><img style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" title="InstallerBootStrap2" src="/UserFiles/Guardian/2009/01/installerbootstrap2-thumb.png" border="0" alt="InstallerBootStrap2" width="248" height="190" /></a>

<a href="/UserFiles/Guardian/2009/01/installerbootstrap3.png"><img style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" title="InstallerBootStrap3" src="/UserFiles/Guardian/2009/01/installerbootstrap3-thumb.png" border="0" alt="InstallerBootStrap3" width="252" height="194" /></a> <a href="/UserFiles/Guardian/2009/01/installerbootstrap4.png"><img style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" title="InstallerBootStrap4" src="/UserFiles/Guardian/2009/01/installerbootstrap4-thumb.png" border="0" alt="InstallerBootStrap4" width="248" height="190" /></a>

To be used the Installation Bootstrap requires that the SQLEXPR.EXE and the application MSI files are placed in the same directory of the bootstrap itself.<br /><br />Converting this project to be used with VS 2005/2008 and the new .NET Framework is really easy.<br /><br />Sample project:
<div id="scid:8eb9d37f-1541-4f29-b6f4-1eea890d4876:3fb062fb-6320-4131-9d11-725e3bc0dd7d" class="wlWriterEditableSmartContent" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px">
<div><a href="/UserFiles/Guardian/2009/01/sidinstallerbootstrap.zip" target="_self">SID.Installer.BootStrap.zip</a></div>
</div>
<div class="wlWriterEditableSmartContent" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px"></div>
<div class="wlWriterEditableSmartContent" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati Tags: <a rel="tag" href="http://technorati.com/tags/SQL+Server+Express">SQL Server Express</a>,<a rel="tag" href="http://technorati.com/tags/Installation">Installation</a>,<a rel="tag" href="http://technorati.com/tags/Embedding">Embedding</a></div><h2>Related Content</h2><ul><li style="list-style-type: none"><a href="http://www.primordialcode.com/blog/post/sql-server-scramble-mask-database-production-data">Sql Server - Scramble / Mask database production data</a> (26/08/2015)</li><li style="list-style-type: none"><a href="http://www.primordialcode.com/blog/post/nhibernate-envers-customize-revision-entity">NHibernate.Envers - Customize the Revision Entity</a> (08/05/2011)</li><li style="list-style-type: none"><a href="http://www.primordialcode.com/blog/post/update-tfs-workspace-codeplex-upgrade-tfs2010">How to update your TFS Workspace after CodePlex upgrade to TFS2010</a> (26/08/2015)</li><li style="list-style-type: none"><a href="http://www.primordialcode.com/blog/post/nhibernate-prepare_sql-considerations-mapping-long-string-fields">NHibernate - prepare_sql and some considerations on mapping very long string fields</a> (26/08/2015)</li><li style="list-style-type: none"><a href="http://www.primordialcode.com/blog/post/silverlight-wcf-fixing-custom-wcf-proxy-generator">Silverlight / WCF: fixing the Custom WCF Proxy Generator</a> (26/08/2015)</li><li style="list-style-type: none"><a href="/Blog/Related/install-sql-server-express-with-your-application"><strong>More related document (6)</strong></a></li></ul><br />

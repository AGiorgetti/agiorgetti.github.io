---
layout: post
title: 'Invoking a Java/AXIS Web Service from .NET: the ‘return null’ issue'
---

<p>When you try invoke a Java/Axis Web Service from a proxy class generated by Visual Studio 2005 or Visual Studio 2008 you often crash against the ‘return null’ issue.</p>  <p>The web service seems to get called correctly and it responds to your client in the right way (you have no exception of any sort), but your returned object is null, it happened to me to face this situation today for the first time, there are a couple of things you can do to debug and resolve this situation:</p>  <ul>   <li>Let’s consider our function call:      <div class="csharpcode-wrapper">       <div class="csharpcode">         <pre class="alt"><span class="lnum">   1:</span> [Test]</pre>

        <pre class="alteven"><span class="lnum">   2:</span> <span class="kwrd">public</span> <span class="kwrd">void</span> T1()</pre>

        <pre class="alt"><span class="lnum">   3:</span> {</pre>

        <pre class="alteven"><span class="lnum">   4:</span>     Test.TestWs ws = <span class="kwrd">new</span> AxisWebService.Test.TestWs ();</pre>

        <pre class="alt"><span class="lnum">   5:</span>     Test.State[] arr = ws.getStates(1);</pre>

        <pre class="alteven"><span class="lnum">   6:</span>     Assert.IsNotNull(arr);</pre>

        <pre class="alt"><span class="lnum">   7:</span> }</pre>
      </div>
    </div>
  </li>
</ul>

<p>here we expect to have back an array of State objects, instead we obtain the hated ‘null’.</p>

<ul>
  <li>The first thing to do is to download and install ‘Fiddler’ (do it right now if you don’t have it already) and have a look at what the web service respond to us (the snippet is a trimmed response): 
    <div class="csharpcode-wrapper">
      <div class="csharpcode">
        <pre class="alt"><span class="lnum">   1:</span> HTTP/1.1 200 OK</pre>

        <pre class="alteven"><span class="lnum">   2:</span> Connection: close</pre>

        <pre class="alt"><span class="lnum">   3:</span> Date: Wed, 15 Oct 2008 12:36:26 GMT</pre>

        <pre class="alteven"><span class="lnum">   4:</span> Server: Microsoft-IIS/6.0</pre>

        <pre class="alt"><span class="lnum">   5:</span> X-Powered-By: ASP.NET</pre>

        <pre class="alteven"><span class="lnum">   6:</span> Content-Type: text/xml;charset=utf-8</pre>

        <pre class="alt"><span class="lnum">   7:</span>&#160; </pre>

        <pre class="alteven"><span class="lnum">   8:</span> <span class="kwrd">&lt;?</span><span class="html">xml</span> <span class="attr">version</span><span class="kwrd">=&quot;1.0&quot;</span> <span class="attr">encoding</span><span class="kwrd">=&quot;utf-8&quot;</span>?<span class="kwrd">&gt;</span></pre>

        <pre class="alt"><span class="lnum">   9:</span> <span class="kwrd">&lt;</span><span class="html">soapenv:Envelope</span> <span class="attr">xmlns:soapenv</span><span class="kwrd">=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span> <span class="attr">xmlns:xsd</span><span class="kwrd">=&quot;http://www.w3.org/2001/XMLSchema&quot;</span> <span class="attr">xmlns:xsi</span><span class="kwrd">=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="kwrd">&gt;</span></pre>

        <pre class="alteven"><span class="lnum">  10:</span> <span class="kwrd">&lt;</span><span class="html">soapenv:Body</span><span class="kwrd">&gt;</span></pre>

        <pre class="alt"><span class="lnum">  11:</span> <span class="kwrd">&lt;</span><span class="html">getStatesResponse</span> <span class="attr">xmlns</span><span class="kwrd">=&quot;&quot;</span><span class="kwrd">&gt;</span></pre>

        <pre class="alteven"><span class="lnum">  12:</span> <span class="kwrd">&lt;</span><span class="html">item</span> <span class="attr">xsi:type</span><span class="kwrd">=&quot;ns1:State&quot;</span> <span class="attr">xmlns:ns1</span><span class="kwrd">=&quot;http://mynamespace.it/&quot;</span><span class="kwrd">&gt;</span></pre>

        <pre class="alt"><span class="lnum">  13:</span> <span class="kwrd">&lt;</span><span class="html">Code</span><span class="kwrd">&gt;</span>A001<span class="kwrd">&lt;/</span><span class="html">Code</span><span class="kwrd">&gt;</span></pre>

        <pre class="alteven"><span class="lnum">  14:</span> <span class="kwrd">&lt;</span><span class="html">Description</span><span class="kwrd">&gt;</span>Test<span class="kwrd">&lt;/</span><span class="html">Description</span><span class="kwrd">&gt;</span></pre>

        <pre class="alt"><span class="lnum">  15:</span> <span class="kwrd">&lt;/</span><span class="html">item</span><span class="kwrd">&gt;</span></pre>

        <pre class="alteven"><span class="lnum">  16:</span> <span class="kwrd">&lt;/</span><span class="html">getStatesResponse</span><span class="kwrd">&gt;</span></pre>

        <pre class="alt"><span class="lnum">  17:</span> <span class="kwrd">&lt;/</span><span class="html">soapenv:Body</span><span class="kwrd">&gt;</span></pre>

        <pre class="alteven"><span class="lnum">  18:</span> <span class="kwrd">&lt;/</span><span class="html">soapenv:Envelope</span><span class="kwrd">&gt;</span></pre>
      </div>
    </div>
  </li>
</ul>

<p>Since the web service is responding correctly the problem is in the deserialization stage of the data stream sent back by the web service.</p>

<ul>
  <li>It’s time to show some hidden file of the solution and look inside the ‘reference.cs’ (this is the default file in which Visual Studio creates some proxy classes). </li>
</ul>

<p>Looking at the proxy classes generated by Visual Studio, it seems that we have all that we need: a class to call the web service and series of classes that map the objects the service returns; where’s the problem then? it turns out that the web service client can’t understand the response stream, so the problem is in a mismatch somewhere.</p>

<p>Given the fact we have all the classes and all of them have the right properties, it’s time to look for the <strong>namespaces</strong>:</p>

<ul>
  <li>Visual Studio 2005 
    <div class="csharpcode-wrapper">
      <div class="csharpcode">
        <pre class="alt"><span class="lnum">   1:</span> [System.Web.Services.Protocols.SoapDocumentMethodAttribute(<span class="str">&quot;http://mynamespace.it/getStates&quot;</span>,</pre>

        <pre class="alteven"><span class="lnum">   2:</span>     Use = System.Web.Services.Description.SoapBindingUse.Literal,</pre>

        <pre class="alt"><span class="lnum">   3:</span>     ParameterStyle = System.Web.Services.Protocols.SoapParameterStyle.Bare)]</pre>

        <pre class="alteven"><span class="lnum">   4:</span> [<span class="kwrd">return</span>: System.Xml.Serialization.XmlArrayAttribute(<span class="str">&quot;getStatesResponse&quot;</span>, Namespace = <span class="str">&quot;http://mynamespace.it/&quot;</span>)]</pre>

        <pre class="alt"><span class="lnum">   5:</span> [<span class="kwrd">return</span>: System.Xml.Serialization.XmlArrayItemAttribute(<span class="str">&quot;item&quot;</span>, Form = System.Xml.Schema.XmlSchemaForm.Unqualified, IsNullable = <span class="kwrd">false</span>)]</pre>

        <pre class="alteven"><span class="lnum">   6:</span> <span class="kwrd">public</span> Stato[] getStates([System.Xml.Serialization.XmlElementAttribute(Namespace = <span class="str">&quot;http://mynamespace.it/&quot;</span>)] <span class="kwrd">int</span> getStatesRequest)</pre>

        <pre class="alt"><span class="lnum">   7:</span> {</pre>

        <pre class="alteven"><span class="lnum">   8:</span>     <span class="kwrd">object</span>[] results = <span class="kwrd">this</span>.Invoke(<span class="str">&quot;getStates&quot;</span>, <span class="kwrd">new</span> <span class="kwrd">object</span>[] {</pre>

        <pre class="alt"><span class="lnum">   9:</span>                 getStatesRequest});</pre>

        <pre class="alteven"><span class="lnum">  10:</span>     <span class="kwrd">return</span> ((State[])(results[0]));</pre>

        <pre class="alt"><span class="lnum">  11:</span> }</pre>
      </div>
    </div>
  </li>
</ul>

<p>pay attention to line number 4:</p>

<div class="csharpcode-wrapper" style="width: 97.5%; height: 33px">
  <div class="csharpcode">
    <pre class="alt"><span class="lnum">   1:</span> [<span class="kwrd">return</span>: System.Xml.Serialization.XmlArrayAttribute(<span class="str">&quot;getStatesResponse&quot;</span>, Namespace = <span class="str">&quot;http://mynamespace.it/&quot;</span>)]</pre>
  </div>
</div>

<p>here it states that the getResponseState element is qualified with the ‘http://mynamespace.it'/’ namespace...but look at what Fiddler captured for us (line 11 of the previous snippet): there we see that the namespace associated with the element is “” (empty string), so here it is our mismatch. To fix the problem you have to manually edit the attribute and correct the namespace to “” (empty string).</p>

<p><strong>Be very careful: writing Namespace = “” or removing it at all are two completely different things.</strong></p>

<p>Having made this fix our test passes and we are able to get our objects back from the web service.</p>

<ul>
  <li>Visual Studio 2008 
    <br />It produces a completely different set of classes to call the web service, we have an interface that describes the service, a series of classes that represent the request and response of each method exposed by the interface and finally we have the proxy classes for the objects returned. We know that the problem is at the ‘client’ side so checking the request classes is useless, we focus our attention on the response classes and on object classes to verify the namespace mappings: 

    <div class="csharpcode-wrapper">
      <div class="csharpcode">
        <pre class="alt"><span class="lnum">   1:</span> [System.Diagnostics.DebuggerStepThroughAttribute()]</pre>

        <pre class="alteven"><span class="lnum">   2:</span> [System.CodeDom.Compiler.GeneratedCodeAttribute(<span class="str">&quot;System.ServiceModel&quot;</span>, <span class="str">&quot;3.0.0.0&quot;</span>)]</pre>

        <pre class="alt"><span class="lnum">   3:</span> [System.ServiceModel.MessageContractAttribute(IsWrapped=<span class="kwrd">false</span>)]</pre>

        <pre class="alteven"><span class="lnum">   4:</span> <span class="kwrd">public</span> <span class="kwrd">partial</span> <span class="kwrd">class</span> getStatesResponse {</pre>

        <pre class="alt"><span class="lnum">   5:</span>     </pre>

        <pre class="alteven"><span class="lnum">   6:</span>     [System.ServiceModel.MessageBodyMemberAttribute(Name=<span class="str">&quot;getStatesResponse&quot;</span>, Namespace=<span class="str">&quot;http://mynamespace.it/&quot;</span>, Order=0)]</pre>

        <pre class="alt"><span class="lnum">   7:</span>     [System.Xml.Serialization.XmlArrayItemAttribute(<span class="str">&quot;item&quot;</span>, Form=System.Xml.Schema.XmlSchemaForm.Unqualified, IsNullable=<span class="kwrd">false</span>)]</pre>

        <pre class="alteven"><span class="lnum">   8:</span>     <span class="kwrd">public</span> State[] getStatesResponse1;</pre>

        <pre class="alt"><span class="lnum">   9:</span>     </pre>

        <pre class="alteven"><span class="lnum">  10:</span>     <span class="kwrd">public</span> getStatesResponse() {</pre>

        <pre class="alt"><span class="lnum">  11:</span>     }</pre>

        <pre class="alteven"><span class="lnum">  12:</span>     </pre>

        <pre class="alt"><span class="lnum">  13:</span>     <span class="kwrd">public</span> getStatesResponse(State[] getStatesResponse1) {</pre>

        <pre class="alteven"><span class="lnum">  14:</span>         <span class="kwrd">this</span>.getStatesResponse1 = getStatesResponse1;</pre>

        <pre class="alt"><span class="lnum">  15:</span>     }</pre>

        <pre class="alteven"><span class="lnum">  16:</span> }</pre>
      </div>
    </div>
  </li>
</ul>

<p>look at line 6, you can see a namespace mismatch again, the fix is the same applied before.</p>

<blockquote>
  <p>In the end, if you are using a Java/Axis Web Service and you get null results from you service calls, don't trust the auto-generated proxy classes too much and check that the attribute that defines the namespace for each object match what you get from the wsdl and from the traced response. </p>
</blockquote>

<p>&#160;</p>


<p></p>

<div class="wlWriterSmartContent" id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:fffa9d56-b141-44db-b072-13e166bfa894" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati Tags: <a href="http://technorati.com/tags/.NET" rel="tag">.NET</a>,<a href="http://technorati.com/tags/Web+Service" rel="tag">Web Service</a>,<a href="http://technorati.com/tags/WCF" rel="tag">WCF</a>,<a href="http://technorati.com/tags/Axis" rel="tag">Axis</a>,<a href="http://technorati.com/tags/Java" rel="tag">Java</a></div>

<p></p>

<p>&#160;</p><h2>Related Content</h2><ul><li style="list-style-type: none"><a href="http://www.primordialcode.com/blog/post/passing-json-serialized-objects-wcf-service-jquery">Passing JSON serialized objects to a WCF service with jQuery</a> (26/08/2015)</li><li style="list-style-type: none"><a href="http://www.primordialcode.com/blog/post/jquery-wcf-json-datetime-serialization">JQuery, WCF and the JSON DateTime serialization</a> (03/04/2010)</li><li style="list-style-type: none"><a href="http://www.primordialcode.com/blog/post/unity-wcf-service-resolution-container-extension">Unity: WCF service resolution container extension</a> (06/08/2009)</li><li style="list-style-type: none"><a href="http://www.primordialcode.com/blog/post/silverlight-wcf-fixing-custom-wcf-proxy-generator">Silverlight / WCF: fixing the Custom WCF Proxy Generator</a> (26/08/2015)</li><li style="list-style-type: none"><a href="http://www.primordialcode.com/blog/post/silverlight-wcf-writing-custom-wcf-proxy-generator-support-validation">Silverlight / WCF : Writing your own Custom WCF Proxy Generator to support validation</a> (12/09/2009)</li><li style="list-style-type: none"><a href="/Blog/Related/invoking-javaaxis-web-service-net-return-null-issue"><strong>More related document (13)</strong></a></li></ul><br />

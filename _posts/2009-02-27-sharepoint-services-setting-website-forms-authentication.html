---
layout: post
title: SharePoint Services - Setting up a Website with Forms Authentication
---

<p>The SharePoint environment is up and running, we can now create a Web Application and a site collection that will be our portal.</p>  <p>The goal is obtain a Web Application with two ‘interfaces’ to the users: we want to expose an internal site to the intranet that will use standard NTLM authentication method and an internet site that will use Forms Authentication; both sites will expose the same contents.</p>  <ul>   <li>Intranet site: <a href="http://sharepointtest">http://sharepointtest</a> - NTLM authentication </li>    <li>Internet site: <a href="http://www.sharepointtest.com">http://www.sharepointtest.com</a> - Forms Authentication </li> </ul>  <p>Let’s start creating the Intranet site.</p>  <p>From the steps made before we should already have a new empty content database (SharePointTestContent) to be used by the web application; to create a web application log to the SharePoint Administration Console and look for ‘Application Management’ -&gt; ‘Create or Extend Web Application’ -&gt; ‘Create a new Web Application’.</p>  <p>You have to fill-in a form that specifies were to place the application and which database to use as the backend storage; I’ll highlight only the critical sections:</p>  <p><a href="/UserFiles/Guardian/2009/02/sharepointiiswebsite1.png"><img title="SharePointIISWebsite" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="203" alt="SharePointIISWebsite" src="/UserFiles/Guardian/2009/02/sharepointiiswebsite-thumb1.png" width="604" border="0" /></a> </p>  <p>I set the port to 80 and the host header to sharepointtest, I recommend of thinking of ports and host headers to use in advance because, once set, it’s not so easy to change them (as we’ll see at the end of the column).</p>  <p>Change the default path for the web application so it will be created in our new directory structure (in this way you have all your files in a single location and it will simplify the deployment on the production machine at a later stage).</p>  <p><a href="/UserFiles/Guardian/2009/02/sharepointapppool1.png"><img title="SharePointAppPool" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="230" alt="SharePointAppPool" src="/UserFiles/Guardian/2009/02/sharepointapppool-thumb1.png" width="604" border="0" /></a> </p>  <p>Define an Application Pool and the account under which the site will run.</p>  <p><a href="/UserFiles/Guardian/2009/02/sharepointdatabase.png"><img title="SharePointDatabase" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="137" alt="SharePointDatabase" src="/UserFiles/Guardian/2009/02/sharepointdatabase-thumb.png" width="604" border="0" /></a> </p>  <p>Specify the content database (created before); if you use Windows authentication make sure have given the right permission to the user defined in the application pool section so she can access the database (that is: give him ‘db_owner’ rights).</p>  <p>We can now create a Site Collection inside the web application: from the administration console select ‘Application Management’ -&gt; ‘Create site collection’; fill in the information required and select a template for the website (I chosen a blank site), wait for the environment to setup the site... et voila, your brand new website is up and running.</p>  <p>We can now put some test content inside the website, for example create a document library and add some files in it).</p>  <p>To create the Internet site we need to extend the web application from the default Zone to the Internet (or extranet) zone, for this purpose we ask SharePoint to create a new website that will be used to present the same content to our external users, after creating the site we change the authorization to Forms Authentication.</p>  <p>To create the new website from the administration console use: ‘Application Management’ -&gt; ‘Create or Extend Web Application’ -&gt; ‘Extend an existing Web Application’</p>  <p>In my test deployment I used with the following settings:</p>  <p>port: 80    <br />host header: www.sharepointtest.com     <br />path C:\SharePoint\WebApps\www.sharepointtest.com80     <br />zone: Internet</p>  <p>before we can use the site we also have to modify the C:\Windows\System32\drivers\etc\hosts file and add the following entries:</p>  <p>127.0.0.1&#160;&#160;&#160; www.sharepointtest.com    <br />::1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; www.sharepointtest.com</p>  <p>so we can browse to the site using the address we specified in the host header section.</p>  <p>After this step we end up having two distinct website: the first to be used in the intranet and the second to be used in an internet scenario. We go on configuring the second one to use Forms Authentication instead of the standard NTLM or Kerberos.</p>  <p>For this purpose we follow the instruction presented here:</p>  <p><a href="http://msdn.microsoft.com/en-us/library/bb975136.aspx" target="_blank">Forms Authentication in SharePoint Products and Technologies (Part 1): Introduction</a></p>  <p>Following the instructions in the above article, we create a new database to hold our users (I named it SharePointUsers)</p>  <p>The test utility they use to create users and roles (MembershipSeeder) is actually hardcoded to be used only with the default ‘aspnetdb’ database, I’ve added a modified version to this article that will allow you to chose also which database to use. You can however use the standard ASP.Net Configuration Application that is generated by Visual Studio when you create a an asp.net website (just create a new website and make the needed changes to the web.config file to enable forms authentication and to point it towards our SharePointUsers database).</p>  <p>Once we completed all the steps we have our two website up and running:</p>  <p><a href="/UserFiles/Guardian/2009/02/sharepointntlmlogin.png"><img title="SharePointNTLMLogin" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="184" alt="SharePointNTLMLogin" src="/UserFiles/Guardian/2009/02/sharepointntlmlogin-thumb.png" width="264" border="0" /></a> <a href="/UserFiles/Guardian/2009/02/sharepointformsauthlogin.png"><img title="SharePointFormsAuthLogin" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="184" alt="SharePointFormsAuthLogin" src="/UserFiles/Guardian/2009/02/sharepointformsauthlogin-thumb.png" width="340" border="0" /></a> </p>  <p>While trying to setup these two sites I learned an important lesson: think carefully and try to plan in advance which ports and which host headers tag you are going to use; changing them is not so easy SharePoint do not offer a way to modify those values and altering them only in IIS (modifying the parameters of the websites) is not enough.</p>  <p>A procedure to change those values is described here: <a href="http://www.virtual-generations.com/2007/03/26/how-to-modify-ports-and-host-headers-on-sharepoint-2007/" target="_blank">How to: modify ports and host headers on SharePoint 2007</a>     <br />Essentially what you have to do is extend an existing web application to a new web application with the right parameters and then remove the original one.</p>  <p>MembershipSeeder:</p>  <p>   <div class="wlWriterEditableSmartContent" id="scid:8eb9d37f-1541-4f29-b6f4-1eea890d4876:dafb70df-a99e-4d4d-ac97-8e844bca3f9c" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px"><p><div><a href="/UserFiles/Guardian/2009/02/membershipseedersource1.zip" target="_self">MembershipSeeder - Source.zip</a></div></p></div> </p>  <p>The next step will be how to develop/deploy web parts and how to remotely debug them.</p>  <p>To be continued…</p>  <div class="wlWriterEditableSmartContent" id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:1c82b691-7ca9-48d4-a8cd-3b8134517878" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati Tags: <a href="http://technorati.com/tags/Forms+Authentication" rel="tag">Forms Authentication</a>,<a href="http://technorati.com/tags/SharePoint" rel="tag">SharePoint</a>,<a href="http://technorati.com/tags/WSS+3.0" rel="tag">WSS 3.0</a></div><h2>Related Content</h2><ul><li style="list-style-type: none"><a href="http://www.primordialcode.com/blog/post/windows-sharepoint-services-developing-and-remotely-debugging-a-web-part">Windows SharePoint Services - Developing and (Remotely) Debugging a Web Part</a> (03/03/2009)</li><li style="list-style-type: none"><a href="http://www.primordialcode.com/blog/post/windows-sharepoint-services-setup">Windows SharePoint Services - first setup</a> (26/08/2015)</li><li style="list-style-type: none"><a href="http://www.primordialcode.com/blog/post/winforms-improving-rendering-performances-backgroundimage-backgroundimagelayout">Winforms: improving rendering performances with BackgroundImage and BackgroundImageLayout</a> (26/08/2015)</li><li style="list-style-type: none"><a href="http://www.primordialcode.com/blog/post/wsssharepoint-adding-filtering-capabilities-customlistviewwebpart-current-user-filter">WSS / SharePoint: adding filtering capabilities to the CustomListViewWebPart (Current User Filter and others)</a> (09/11/2009)</li><li style="list-style-type: none"><a href="http://www.primordialcode.com/blog/post/get-sharepoint-designer-2007-for-free">Get SharePoint Designer 2007 for Free</a> (04/03/2009)</li><li style="list-style-type: none"><a href="/Blog/Related/sharepoint-services-setting-website-forms-authentication"><strong>More related document (3)</strong></a></li></ul><br />

---
layout: post
title: Creating a ‘Windows Installation’ bootable USB drive
---

<p>Recently I was in need to setup some new hardware and I’ve found myself doing this procedure over and over (because I am a cheap b*****d and I only own few USB pen drives <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-openmouthedsmile" alt="Open-mouthed smile" src="http://www.primordialcode.com/UserFiles/Guardian/wlEmoticon-openmouthedsmile_2_9.png" />) again. So even if there are plenty of posts out there offering more or less the same content, I’ll write it down here as a reminder to myself.</p>  <p>Consider you can use this very same procedure to create a bootable USB flash drive to install any Microsoft Windows OS (from Vista to 2008 Server R2).</p>  <h3>Prepare and Format the drive</h3>  <p>You can do these first steps in several way, I prefer to use the <strong>diskpart</strong> command line utility; BE CAREFUL HERE! If you do something wrong you may easily wipeout you disks!&#160; </p>  <ol>   <li>Open a command prompt as administrator (Right click on Start &gt; All Programs &gt; Accessories &gt; Command Prompt and select “Run as administrator”)      <br /></li>    <li>type the following commands into the Command Prompt Window:      <br />      <br />&#160; diskpart       <br />      <br />&#160; list disk       <br />      <br />This will bring up a list of all your physical drives installed; look for your USB drive and take note of the number; if you have multiple USB drives attached I suggest you to disconnect them all but the one you want to use: the only way to identify the drive is looking at the drive’s size in this step, having multiple USB drives with the same capacity is not good!       <br /></li>    <li>Format the drive by typing the following commands into the same window. Replace “X” with the number of your disk.      <br />      <br />select disk X      <br />      <br />clean       <br />      <br />create partition primary      <br />       <br />select partition 1       <br />      <br />active       <br />      <br />format fs=NTFS       <br />      <br />assign       <br />      <br />exit       <br />      <br />At this stage we have a clean formatted USB with an active partition ready to be made bootable. Some guides will tell you to format the pen drive using FAT32, I always prefer to use NTFS especially to create bootable winpe drives to use the imagex.exe utility to clone systems, in this scenario we can easily break through the FAT32 file size limit.</li> </ol>  <h3>Make the drive bootable</h3>  <p>To make the drive bootable we will use the <strong>bootsect</strong> utility that comes along with any Microsoft Windows OS:</p>  <ol>   <li>Insert your OS DVD.     <br /></li>    <li>Change directory to X:\boot (where X is your dvd drive).     <br /></li>    <li>Type the following instruction to make the drive bootable (now ‘X’ is your pen drive).     <br />      <br />bootsect /nt60 X:      <br /></li>    <li>Close the Command Prompt Window.</li> </ol>  <p>&#160;</p>  <p>The last step is copy all your installation files from the DVD (or ISO) to your newly created bootable USB flash drive.</p>  <p>If you do not want to do everything by hand, there’s a tool from Microsoft you can use to do the very same work: <a href="http://www.microsoftstore.com/store/msstore/html/pbPage.Help_Win7_usbdvd_dwnTool">Windows 7 USB/DVD download tool</a>.</p>
